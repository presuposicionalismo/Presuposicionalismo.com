---
import { getCollection } from "astro:content";
import CardBook from "./CardBook.astro";

const books = (await getCollection("libros")).sort((a, b) =>
  a.data.title.localeCompare(b.data.title)
);
---

<section class="book-carousel">
  <h2>Nuestra Biblioteca</h2>
  <div class="carousel-container">
    {books.map((book) => (
      <div class="carousel-item">
        <CardBook
          title={book.data.title}
          coverBook={book.data.coverBook}
          slug={book.slug}
        />
      </div>
    ))}
  </div>
  <div class="more-link">
    <a href="/libros">Explorar la biblioteca completa</a>
  </div>
</section>

<style>
  .book-carousel {
    padding-top: var(--size-fluid-3);
    padding-bottom: var(--size-fluid-3);
  }

  .book-carousel h2 {
    text-align: center;
    font-size: var(--font-size-xl);
    margin-bottom: var(--size-fluid-3);
  }

  .carousel-container {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    gap: var(--size-fluid-2);
    padding-bottom: var(--size-fluid-2); /* For scrollbar */
  }

  .carousel-item {
    flex: 0 0 50%; /* Show 2 items on mobile */
    scroll-snap-align: center;
  }

  @media (min-width: 601px) {
    .carousel-item {
      flex: 0 0 25%; /* Show 4 items on tablet */
    }
  }

  @media (min-width: 1024px) {
    .carousel-item {
      flex: 0 0 15%; /* Show ~6-7 items on desktop */
    }
  }

  .carousel-container::-webkit-scrollbar {
    height: 8px;
  }

  .carousel-container::-webkit-scrollbar-thumb {
    background: var(--surface-2);
    border-radius: var(--radius-2);
  }

  .carousel-container::-webkit-scrollbar-track {
    background: var(--surface-1);
  }

    .more-link {
        text-align: center;
        margin-top: var(--size-fluid-3);
    }

    .more-link a {
        color: var(--text-1);
        text-decoration: none;
        font-weight: 500;
        border-bottom: 2px solid var(--brand);
        padding-bottom: var(--size-1);
        transition: color 0.2s ease-in-out, border-color 0.2s ease-in-out;
    }

    .more-link a:hover {
        color: var(--brand);
    }
</style>
