---
import BaseLayout from "../layouts/BaseLayout.astro";
import GraphView from "../components/GraphView.svelte";
import { getGraphData } from "../utils/graphData";

const { nodes, links } = await getGraphData();
---

<BaseLayout
    title="Grafo de Conocimiento | Presuposicionalismo.com"
    description="Explora las conexiones temáticas entre nuestros artículos y lecciones."
>
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-10">
            <h1
                class="text-3xl md:text-5xl font-bold mb-4 text-accent font-urbanist"
            >
                Mapa de Conocimiento
            </h1>
            <p class="text-muted max-w-2xl mx-auto">
                Visualiza cómo se interconectan los conceptos, autores y temas
                en nuestro contenido. Usa el buscador para filtrar temas
                específicos.
            </p>
        </header>

        <div class="max-w-6xl mx-auto">
            <GraphView
                client:load
                nodes={nodes}
                links={links}
                on:nodeClick={(e) => {
                    const { node } = e.detail;
                    if (node.group === "post" && node.slug) {
                        window.location.href = `/blog/${node.slug}`;
                    }
                }}
            />
        </div>
    </div>
</BaseLayout>
